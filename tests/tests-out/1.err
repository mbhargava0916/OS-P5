[MS_Run:339] Initializing MiniSpark
[MS_Run:341] Creating thread pool with 12 threads
[list_init:52] Creating list with capacity 16
[MS_Run:355] Creating worker thread 0
[MS_Run:355] Creating worker thread 1
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[worker_thread:139] Worker thread starting
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 2
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 3
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 4
[MS_Run:355] Creating worker thread 5
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 6
[worker_thread:139] Worker thread starting
[MS_Run:355] Creating worker thread 7
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 8
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 9
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[MS_Run:355] Creating worker thread 10
[MS_Run:355] Creating worker thread 11
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[worker_thread:139] Worker thread starting
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[list_init:52] Creating list with capacity 16
[MS_Run:360] Creating metric thread
[MS_Run:362] MiniSpark initialization complete
[RDDFromFiles:584] Creating FILE_BACKED RDD from 3 files
[list_init:52] Creating list with capacity 3
[RDDFromFiles:592] Opening file ./test_files/one.txt
[metric_thread_func:294] Metric thread starting
[list_init:52] Creating list with capacity 1
[list_add_elem:70] Adding element 0x561846a43470 (list size now 1)
[list_set_elem:114] Setting element 0 to 0x561846a43650 (size was 0)
[RDDFromFiles:611] Added file ./test_files/one.txt as partition 0
[RDDFromFiles:592] Opening file ./test_files/two.txt
[list_init:52] Creating list with capacity 1
[list_add_elem:70] Adding element 0x561846a43690 (list size now 1)
[list_set_elem:114] Setting element 1 to 0x561846a43870 (size was 1)
[RDDFromFiles:611] Added file ./test_files/two.txt as partition 1
[RDDFromFiles:592] Opening file ./test_files/three.txt
[list_init:52] Creating list with capacity 1
[list_add_elem:70] Adding element 0x561846a438b0 (list size now 1)
[list_set_elem:114] Setting element 2 to 0x561846a43a90 (size was 2)
[RDDFromFiles:611] Added file ./test_files/three.txt as partition 2
[RDDFromFiles:613] Created FILE_BACKED RDD 0x561846a433f0 with 3 partitions
[map:552] Creating MAP RDD from 0x561846a433f0
[create_rdd:533] Creating RDD with 1 dependencies, transform 0
[create_rdd:543] Added dependency 0: RDD 0x561846a433f0
[create_rdd:547] Created RDD 0x561846a43ad0
[print:493] Printing RDD 0x561846a43ad0
[execute:413] Executing RDD 0x561846a43ad0 (transformation 0)
[execute:417] Materializing dependency 0 for RDD 0x561846a43ad0
[execute:413] Executing RDD 0x561846a433f0 (transformation 4)
[list_size:124] List size: 3
[execute:451] Set active tasks to 3 for RDD 0x561846a433f0
[list_size:124] List size: 3
[list_add_elem:70] Adding element 0x561846a43b10 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 0 (queue size now 1)
[list_size:124] List size: 3
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43b10 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a433f0 partition 0 (queue size now 0)
[worker_thread:161] Task scheduled at 575133.772666951
[list_get_elem:83] Returning element 0: 0x561846a43650
[worker_thread:272] Task completed in 10 microseconds
[list_add_elem:70] Adding element 0x561846a43b30 (list size now 1)
[worker_thread:281] Active tasks remaining: 2
[list_add_elem:70] Adding element 0x561846a43b70 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 1 (queue size now 1)
[list_size:124] List size: 3
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43b70 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a433f0 partition 1 (queue size now 0)
[worker_thread:161] Task scheduled at 575133.772763408
[list_get_elem:83] Returning element 1: 0x561846a43870
[worker_thread:272] Task completed in 14 microseconds
[list_add_elem:70] Adding element 0x561846a43b90 (list size now 2)
[worker_thread:281] Active tasks remaining: 1
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[list_add_elem:70] Adding element 0x561846a43bd0 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 2 (queue size now 1)
[list_size:124] List size: 3
[execute:472] Waiting for 1 tasks to complete for RDD 0x561846a433f0
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43bd0 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a433f0 partition 2 (queue size now 0)
[worker_thread:161] Task scheduled at 575133.772911782
[list_get_elem:83] Returning element 2: 0x561846a43a90
[worker_thread:272] Task completed in 18 microseconds
[list_add_elem:70] Adding element 0x561846a43bf0 (list size now 3)
[worker_thread:281] Active tasks remaining: 0
[worker_thread:283] Signaling completion of all tasks
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[execute:476] All tasks completed for RDD 0x561846a433f0
[list_size:124] List size: 3
[execute:441] Creating 3 partitions for RDD 0x561846a43ad0
[list_init:52] Creating list with capacity 3
[list_add_elem:70] Adding element (nil) (list size now 1)
[list_size:124] List size: 1
[execute:445] Added partition 0 (size now 1)
[list_add_elem:70] Adding element (nil) (list size now 2)
[list_size:124] List size: 2
[execute:445] Added partition 1 (size now 2)
[list_add_elem:70] Adding element (nil) (list size now 3)
[list_size:124] List size: 3
[execute:445] Added partition 2 (size now 3)
[list_size:124] List size: 3
[execute:451] Set active tasks to 3 for RDD 0x561846a43ad0
[list_size:124] List size: 3
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[list_size:124] List size: 3
[metric_thread_func:303] Metric thread checking queue (size=3)
[list_size:124] List size: 3
[list_remove_first:97] Removing first element 0x561846a43b30 (size was 3)
[metric_thread_func:317] Processing metric for RDD 0x561846a433f0 partition 0
[print_formatted_metric:330] Writing metric to file
[list_add_elem:70] Adding element 0x561846a43c70 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 0 (queue size now 1)
[list_size:124] List size: 3
[list_size:124] List size: 2
[metric_thread_func:303] Metric thread checking queue (size=2)
[list_size:124] List size: 2
[list_remove_first:97] Removing first element 0x561846a43b90 (size was 2)
[metric_thread_func:317] Processing metric for RDD 0x561846a433f0 partition 1
[print_formatted_metric:330] Writing metric to file
[list_size:124] List size: 1
[metric_thread_func:303] Metric thread checking queue (size=1)
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43bf0 (size was 1)
[metric_thread_func:317] Processing metric for RDD 0x561846a433f0 partition 2
[print_formatted_metric:330] Writing metric to file
[list_size:124] List size: 0
[metric_thread_func:303] Metric thread checking queue (size=0)
[list_size:124] List size: 0
[metric_thread_func:305] Metric thread waiting
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43c70 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a43ad0 partition 0 (queue size now 0)
[worker_thread:161] Task scheduled at 575133.773411970
[list_get_elem:83] Returning element 0: (nil)
[list_init:52] Creating list with capacity 16
[list_add_elem:70] Adding element 0x561846a43cd0 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 1 (queue size now 1)
[list_size:124] List size: 3
[worker_thread:165] Created new partition 0x7eff94000b70 for RDD 0x561846a43ad0 partition 0
[list_set_elem:114] Setting element 0 to 0x7eff94000b70 (size was 3)
[list_get_elem:83] Returning element 0: 0x561846a43650
[worker_thread:171] Processing MAP on RDD 0x561846a43ad0 partition 0 (dep RDD 0x561846a433f0 partition 0x561846a43650)
[list_get_elem:83] Returning element 0: 0x561846a43470
[worker_thread:176] Processing FILE_BACKED partition with FILE* 0x561846a43470
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43cd0 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a43ad0 partition 1 (queue size now 0)
[worker_thread:191] Adding line copy 0x7eff94001cb0: one
[list_add_elem:70] Adding element 0x7eff94001cb0 (list size now 1)
[worker_thread:191] Adding line copy 0x7eff94001cd0: two
[list_add_elem:70] Adding element 0x7eff94001cd0 (list size now 2)
[worker_thread:191] Adding line copy 0x7eff94001cf0: three
[list_add_elem:70] Adding element 0x7eff94001cf0 (list size now 3)
[list_size:124] List size: 3
[worker_thread:196] Finished reading file (partition now has 3 elements)
[worker_thread:272] Task completed in 191 microseconds
[list_add_elem:70] Adding element 0x561846a43c90 (list size now 1)
[worker_thread:281] Active tasks remaining: 2
[worker_thread:161] Task scheduled at 575133.773558889
[list_get_elem:83] Returning element 1: (nil)
[list_init:52] Creating list with capacity 16
[list_add_elem:70] Adding element 0x561846a43d30 (list size now 1)
[list_size:124] List size: 1
[execute:465] Added task for partition 2 (queue size now 1)
[metric_thread_func:307] Metric thread woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43c90 (size was 1)
[metric_thread_func:317] Processing metric for RDD 0x561846a43ad0 partition 0
[print_formatted_metric:330] Writing metric to file
[list_size:124] List size: 0
[metric_thread_func:303] Metric thread checking queue (size=0)
[list_size:124] List size: 0
[metric_thread_func:305] Metric thread waiting
[worker_thread:147] Worker woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43d30 (size was 1)
[list_size:124] List size: 0
[worker_thread:157] Worker got task for RDD 0x561846a43ad0 partition 2 (queue size now 0)
[worker_thread:161] Task scheduled at 575133.773774835
[list_get_elem:83] Returning element 2: (nil)
[list_init:52] Creating list with capacity 16
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[worker_thread:165] Created new partition 0x7eff8c000b70 for RDD 0x561846a43ad0 partition 2
[list_set_elem:114] Setting element 2 to 0x7eff8c000b70 (size was 3)
[list_get_elem:83] Returning element 2: 0x561846a43a90
[worker_thread:171] Processing MAP on RDD 0x561846a43ad0 partition 2 (dep RDD 0x561846a433f0 partition 0x561846a43a90)
[list_get_elem:83] Returning element 0: 0x561846a438b0
[worker_thread:176] Processing FILE_BACKED partition with FILE* 0x561846a438b0
[worker_thread:165] Created new partition 0x7eff88000b70 for RDD 0x561846a43ad0 partition 1
[list_set_elem:114] Setting element 1 to 0x7eff88000b70 (size was 3)
[list_get_elem:83] Returning element 1: 0x561846a43870
[worker_thread:171] Processing MAP on RDD 0x561846a43ad0 partition 1 (dep RDD 0x561846a433f0 partition 0x561846a43870)
[list_get_elem:83] Returning element 0: 0x561846a43690
[worker_thread:176] Processing FILE_BACKED partition with FILE* 0x561846a43690
[worker_thread:191] Adding line copy 0x7eff8c001cb0: one
[list_add_elem:70] Adding element 0x7eff8c001cb0 (list size now 1)
[worker_thread:191] Adding line copy 0x7eff8c001cd0: two
[list_add_elem:70] Adding element 0x7eff8c001cd0 (list size now 2)
[worker_thread:191] Adding line copy 0x7eff8c001cf0: three four five
[list_add_elem:70] Adding element 0x7eff8c001cf0 (list size now 3)
[worker_thread:191] Adding line copy 0x7eff8c001d10: six
[list_add_elem:70] Adding element 0x7eff8c001d10 (list size now 4)
[worker_thread:191] Adding line copy 0x7eff8c001d30: 
[list_add_elem:70] Adding element 0x7eff8c001d30 (list size now 5)
[list_size:124] List size: 5
[worker_thread:196] Finished reading file (partition now has 5 elements)
[worker_thread:272] Task completed in 249 microseconds
[list_add_elem:70] Adding element 0x561846a43d50 (list size now 1)
[worker_thread:191] Adding line copy 0x7eff88001cb0: one
[list_add_elem:70] Adding element 0x7eff88001cb0 (list size now 1)
[worker_thread:191] Adding line copy 0x7eff88001cd0: two
[list_add_elem:70] Adding element 0x7eff88001cd0 (list size now 2)
[worker_thread:191] Adding line copy 0x7eff88001cf0: three
[list_add_elem:70] Adding element 0x7eff88001cf0 (list size now 3)
[worker_thread:191] Adding line copy 0x7eff88001d10: four
[list_add_elem:70] Adding element 0x7eff88001d10 (list size now 4)
[worker_thread:191] Adding line copy 0x7eff88001d30: five
[list_add_elem:70] Adding element 0x7eff88001d30 (list size now 5)
[worker_thread:191] Adding line copy 0x7eff88001d50: one
[list_add_elem:70] Adding element 0x7eff88001d50 (list size now 6)
[worker_thread:191] Adding line copy 0x7eff88001d70: extra text one
[list_add_elem:70] Adding element 0x7eff88001d70 (list size now 7)
[list_size:124] List size: 7
[worker_thread:196] Finished reading file (partition now has 7 elements)
[worker_thread:272] Task completed in 578 microseconds
[worker_thread:281] Active tasks remaining: 1
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[list_size:124] List size: 3
[execute:472] Waiting for 1 tasks to complete for RDD 0x561846a43ad0
[metric_thread_func:307] Metric thread woke up
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43d50 (size was 1)
[metric_thread_func:317] Processing metric for RDD 0x561846a43ad0 partition 2
[print_formatted_metric:330] Writing metric to file
[list_add_elem:70] Adding element 0x561846a43cf0 (list size now 1)
[worker_thread:281] Active tasks remaining: 0
[worker_thread:283] Signaling completion of all tasks
[worker_thread:142] Worker acquired queue lock
[list_size:124] List size: 0
[worker_thread:145] Worker waiting for work
[list_size:124] List size: 1
[metric_thread_func:303] Metric thread checking queue (size=1)
[list_size:124] List size: 1
[list_remove_first:97] Removing first element 0x561846a43cf0 (size was 1)
[metric_thread_func:317] Processing metric for RDD 0x561846a43ad0 partition 1
[print_formatted_metric:330] Writing metric to file
[list_size:124] List size: 0
[metric_thread_func:303] Metric thread checking queue (size=0)
[list_size:124] List size: 0
[metric_thread_func:305] Metric thread waiting
[execute:476] All tasks completed for RDD 0x561846a43ad0
[list_size:124] List size: 3
[list_get_elem:83] Returning element 0: 0x7eff94000b70
[list_size:124] List size: 3
[print:511] Printing partition 0 with 3 elements
[list_size:124] List size: 3
[list_get_elem:83] Returning element 0: 0x7eff94001cb0
[print:516] Printing element 0x7eff94001cb0
[list_size:124] List size: 3
[list_get_elem:83] Returning element 1: 0x7eff94001cd0
[print:516] Printing element 0x7eff94001cd0
[list_size:124] List size: 3
[list_get_elem:83] Returning element 2: 0x7eff94001cf0
[print:516] Printing element 0x7eff94001cf0
[list_size:124] List size: 3
[list_free:133] Freeing list with 3 elements
[list_size:124] List size: 3
[list_get_elem:83] Returning element 1: 0x7eff88000b70
[list_size:124] List size: 7
[print:511] Printing partition 1 with 7 elements
[list_size:124] List size: 7
[list_get_elem:83] Returning element 0: 0x7eff88001cb0
[print:516] Printing element 0x7eff88001cb0
[list_size:124] List size: 7
[list_get_elem:83] Returning element 1: 0x7eff88001cd0
[print:516] Printing element 0x7eff88001cd0
[list_size:124] List size: 7
[list_get_elem:83] Returning element 2: 0x7eff88001cf0
[print:516] Printing element 0x7eff88001cf0
[list_size:124] List size: 7
[list_get_elem:83] Returning element 3: 0x7eff88001d10
[print:516] Printing element 0x7eff88001d10
[list_size:124] List size: 7
[list_get_elem:83] Returning element 4: 0x7eff88001d30
[print:516] Printing element 0x7eff88001d30
[list_size:124] List size: 7
[list_get_elem:83] Returning element 5: 0x7eff88001d50
[print:516] Printing element 0x7eff88001d50
[list_size:124] List size: 7
[list_get_elem:83] Returning element 6: 0x7eff88001d70
[print:516] Printing element 0x7eff88001d70
[list_size:124] List size: 7
[list_free:133] Freeing list with 7 elements
[list_size:124] List size: 3
[list_get_elem:83] Returning element 2: 0x7eff8c000b70
[list_size:124] List size: 5
[print:511] Printing partition 2 with 5 elements
[list_size:124] List size: 5
[list_get_elem:83] Returning element 0: 0x7eff8c001cb0
[print:516] Printing element 0x7eff8c001cb0
[list_size:124] List size: 5
[list_get_elem:83] Returning element 1: 0x7eff8c001cd0
[print:516] Printing element 0x7eff8c001cd0
[list_size:124] List size: 5
[list_get_elem:83] Returning element 2: 0x7eff8c001cf0
[print:516] Printing element 0x7eff8c001cf0
[list_size:124] List size: 5
[list_get_elem:83] Returning element 3: 0x7eff8c001d10
[print:516] Printing element 0x7eff8c001d10
[list_size:124] List size: 5
[list_get_elem:83] Returning element 4: 0x7eff8c001d30
[print:516] Printing element 0x7eff8c001d30
[list_size:124] List size: 5
[list_free:133] Freeing list with 5 elements
[list_size:124] List size: 3
[list_free:133] Freeing list with 3 elements
[print:529] Finished printing RDD 0x561846a43ad0
[MS_TearDown:371] Initiating shutdown sequence
[MS_TearDown:375] Broadcasting shutdown to workers
[MS_TearDown:380] Signaling metric thread to shutdown
[MS_TearDown:384] Joining worker threads
[MS_TearDown:386] Joining worker thread 0
[metric_thread_func:307] Metric thread woke up
[list_size:124] List size: 0
[metric_thread_func:311] Metric thread shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[MS_TearDown:386] Joining worker thread 1
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[worker_thread:147] Worker woke up
[worker_thread:151] Worker shutting down
[MS_TearDown:386] Joining worker thread 2
[MS_TearDown:386] Joining worker thread 3
[MS_TearDown:386] Joining worker thread 4
[MS_TearDown:386] Joining worker thread 5
[MS_TearDown:386] Joining worker thread 6
[MS_TearDown:386] Joining worker thread 7
[MS_TearDown:386] Joining worker thread 8
[MS_TearDown:386] Joining worker thread 9
[MS_TearDown:386] Joining worker thread 10
[MS_TearDown:386] Joining worker thread 11
[MS_TearDown:390] Joining metric thread
[metric_thread_func:325] Metric thread exiting
[MS_TearDown:393] Cleaning up resources
[list_free:133] Freeing list with 0 elements
[list_size:124] List size: 0
[list_free:133] Freeing list with 0 elements
[MS_TearDown:409] Shutdown complete
